<!DOCTYPE html>
<html lang="en"><!-- Mirrored from www.slimframework.com/docs/concepts/middleware.html by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 22 Jun 2016 21:03:40 GMT --><!-- Added by HTTrack --><head><meta content="text/html;charset=utf-8" http-equiv="content-type"/><!-- /Added by HTTrack -->

        <meta charset="utf-8"/>
        <meta content="width=device-width, initial-scale=1, maximum-scale=1" name="viewport"/>
        <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible"/>
        <title>Middleware - Slim Framework</title>
        <meta content="" name="description"/>
        <meta content="index, follow" name="robots"/>
        <meta content="Middleware" property="og:title"/>
        <meta content="Slim Framework" property="og:site_name"/>
        <meta content="middleware.html" property="og:url"/>
        <meta content="" property="og:description"/>
        <meta content="website" property="og:type"/>
        <!--[if lt IE 9]><script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
        <link href="../../assets/css/all.css" rel="stylesheet"/>
        <link href="../../assets/images/favicon.png" rel="shortcut icon"/>
        <link href="../../../maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet"/>
        
        
        
    </head>
    <body style="padding-top: 5em">
        <nav class="navbar navbar-default navbar-fixed-top">
            <div class="container-fluid">
                <!-- Brand and toggle get grouped for better mobile display -->
                <div class="navbar-header">
                    <button aria-expanded="false" class="navbar-toggle collapsed" data-target="#bs-example-navbar-collapse-1" data-toggle="collapse" type="button">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="http://www.slimframework.com/"><img alt="Slim" height="24px" src="../../assets/images/favicon.png"/></a>
                </div>

                <!-- Collect the nav links, forms, and other content for toggling -->
                <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                    <ul class="nav navbar-nav">
                        <li><a href="http://www.slimframework.com/blog">Blog</a></li>
                        <li class="active"><a href="../index.html">User Guide</a></li>
                        <li><a href="http://discourse.slimframework.com/">Support</a></li>
                        <li><a href="http://www.slimframework.com/contribute">Contribute</a></li>
                        <li><a href="https://www.stickermule.com/user/1070648464/stickers" target="_blank"><i class="fa fa-heart"></i> Goodies</a></li>
                    </ul>
                </div>
            </div>
        </nav>

<div class="wrapper docs">
    <div class="container-fluid">
        <header class="site-header">
            <div class="site-title"><a href="http://www.slimframework.com/">Slim</a></div>
            <div class="site-slogan">a micro framework for PHP</div>
        </header>

        <div class="row">
            <div class="col-md-3">
                <form class="searchbox" novalidate="novalidate" onsubmit="return false;" style="visibility:hidden;height:0">
                    <div class="searchbox__wrapper" role="search">
                        <input autocomplete="off" class="searchbox__input" id="docsearch" name="search" placeholder="Search in the doc" required="required" type="search"/>
                        <button class="searchbox__submit" title="Submit your search query." type="submit">
                            <svg aria-label="Search" role="img">
                                <use xlink:href="#sbx-icon-search-13" xmlns:xlink="http://www.w3.org/1999/xlink"></use>
                            </svg>
                        </button>
                        <button class="searchbox__reset hide" title="Clear the search query." type="reset">
                            <svg aria-label="Reset" role="img">
                                <use xlink:href="#sbx-icon-clear-3" xmlns:xlink="http://www.w3.org/1999/xlink"></use>
                            </svg>
                        </button>
                    </div>
                </form>

                <div class="svg-icons" style="height: 0; width: 0; position: absolute; visibility: hidden">
                    <svg xmlns="http://www.w3.org/2000/svg">
                        <symbol id="sbx-icon-clear-3" viewBox="0 0 40 40"><path d="M16.228 20L1.886 5.657 0 3.772 3.772 0l1.885 1.886L20 16.228 34.343 1.886 36.228 0 40 3.772l-1.886 1.885L23.772 20l14.342 14.343L40 36.228 36.228 40l-1.885-1.886L20 23.772 5.657 38.114 3.772 40 0 36.228l1.886-1.885L16.228 20z" fill-rule="evenodd"></path></symbol>
                        <symbol id="sbx-icon-search-13" viewBox="0 0 40 40"><path d="M26.806 29.012a16.312 16.312 0 0 1-10.427 3.746C7.332 32.758 0 25.425 0 16.378 0 7.334 7.333 0 16.38 0c9.045 0 16.378 7.333 16.378 16.38 0 3.96-1.406 7.593-3.746 10.426L39.547 37.34c.607.608.61 1.59-.004 2.203a1.56 1.56 0 0 1-2.202.004L26.807 29.012zm-10.427.627c7.322 0 13.26-5.938 13.26-13.26 0-7.324-5.938-13.26-13.26-13.26-7.324 0-13.26 5.936-13.26 13.26 0 7.322 5.936 13.26 13.26 13.26z" fill-rule="evenodd"></path></symbol>
                    </svg>
                </div>

                
                    
                    
                    <h3 class="toc-title">Get Started</h3>
                    <ul class="toc-links">
                        
                        <li><a href="../index.html">Home</a></li>
                        
                        <li><a href="../start/installation.html">Installation</a></li>
                        
                        <li><a href="../start/upgrade.html">Upgrade Guide</a></li>
                        
                        <li><a href="../start/web-servers.html">Web Servers</a></li>
                        
                    </ul>
                
                    
                    
                    <h3 class="toc-title">Tutorial</h3>
                    <ul class="toc-links">
                        
                        <li><a href="../tutorial/first-app.html">First Application</a></li>
                        
                    </ul>
                
                    
                    
                    <h3 class="toc-title active">Concepts</h3>
                    <ul class="toc-links">
                        
                        <li><a href="value-objects.html">PSR 7</a></li>
                        
                        <li><a href="middleware.html">Middleware</a></li>
                        
                        <li><a href="di.html">Dependency Container</a></li>
                        
                    </ul>
                
                    
                    
                    <h3 class="toc-title">The Application</h3>
                    <ul class="toc-links">
                        
                        <li><a href="../objects/application.html">Overview</a></li>
                        
                        <li><a href="../objects/application.html#application-configuration">Configuration</a></li>
                        
                        <li><a href="../objects/application.html#slim-default-settings">Default settings</a></li>
                        
                    </ul>
                
                    
                    
                    <h3 class="toc-title">The Request</h3>
                    <ul class="toc-links">
                        
                        <li><a href="../objects/request.html">Overview</a></li>
                        
                        <li><a href="../objects/request.html#the-request-method">Method</a></li>
                        
                        <li><a href="../objects/request.html#the-request-headers">Headers</a></li>
                        
                        <li><a href="../objects/request.html#the-request-body">Body</a></li>
                        
                        <li><a href="../objects/request.html#request-helpers">Helpers</a></li>
                        
                        <li><a href="../objects/request.html#route-object">Route object</a></li>
                        
                        <li><a href="../objects/request.html#media-type-parsers">Media type parsers</a></li>
                        
                    </ul>
                
                    
                    
                    <h3 class="toc-title">The Response</h3>
                    <ul class="toc-links">
                        
                        <li><a href="../objects/response.html">Overview</a></li>
                        
                        <li><a href="../objects/response.html#the-response-status">Status</a></li>
                        
                        <li><a href="../objects/response.html#the-response-headers">Headers</a></li>
                        
                        <li><a href="../objects/response.html#the-response-body">Body</a></li>
                        
                        <li><a href="../objects/response.html#returning-json">JSON</a></li>
                        
                    </ul>
                
                    
                    
                    <h3 class="toc-title">Routing</h3>
                    <ul class="toc-links">
                        
                        <li><a href="../objects/router.html">Overview</a></li>
                        
                        <li><a href="../objects/router.html#how-to-create-routes">Create Routes</a></li>
                        
                        <li><a href="../objects/router.html#route-callbacks">Callbacks</a></li>
                        
                        <li><a href="../objects/router.html#route-strategies">Strategies</a></li>
                        
                        <li><a href="../objects/router.html#route-placeholders">Placeholders</a></li>
                        
                        <li><a href="../objects/router.html#route-names">Names</a></li>
                        
                        <li><a href="../objects/router.html#route-groups">Groups</a></li>
                        
                        <li><a href="../objects/router.html#route-middleware">Middleware</a></li>
                        
                        <li><a href="../objects/router.html#container-resolution">Container Resolution</a></li>
                        
                    </ul>
                
                    
                    
                    <h3 class="toc-title">Error Handling</h3>
                    <ul class="toc-links">
                        
                        <li><a href="../handlers/error.html">Error Handlers</a></li>
                        
                        <li><a href="../handlers/not-found.html">404 Not Found</a></li>
                        
                        <li><a href="../handlers/not-allowed.html">405 Not Allowed</a></li>
                        
                    </ul>
                
                    
                    
                    <h3 class="toc-title">Cook book</h3>
                    <ul class="toc-links">
                        
                        <li><a href="../cookbook/route-patterns.html">Trailing / in routes</a></li>
                        
                        <li><a href="../cookbook/ip-address.html">Retrieving IP address</a></li>
                        
                        <li><a href="../cookbook/retrieving-current-route.html">Retrieving Current Route</a></li>
                        
                        <li><a href="../cookbook/database-eloquent.html">Using Eloquent with Slim</a></li>
                        
                    </ul>
                
                    
                    
                    <h3 class="toc-title">Add Ons</h3>
                    <ul class="toc-links">
                        
                        <li><a href="../features/templates.html">Templates</a></li>
                        
                        <li><a href="../features/caching.html">HTTP Caching</a></li>
                        
                        <li><a href="../features/csrf.html">CSRF Protection</a></li>
                        
                        <li><a href="../features/flash.html">Flash Messages</a></li>
                        
                        <li><a href="https://github.com/slimphp/Slim/wiki/Middleware-for-Slim-Framework-v3.x">3rd Party</a></li>
                        
                    </ul>
                
                    
                    
                    <h3 class="toc-title">Contributing</h3>
                    <ul class="toc-links">
                        
                        <li><a href="../contributors/strategy.html">Branching Strategy</a></li>
                        
                        <li><a href="../contributors/guidelines.html">Guidelines</a></li>
                        
                    </ul>
                
            </div>

            <div class="col-md-8 docs-content">
                <h1 class="page-header"><a class="dashAnchor" name="//apple_ref/cpp/Section/Middleware"></a>Middleware</h1>
                <div class="edit-panel" style="margin: 0 0 1em 0;">
                    <a class="btn btn-default btn-xs" href="https://github.com/slimphp/Slim-Website/tree/gh-pages/docs/concepts/middleware.md" target="_blank"><i class="fa fa-github"></i> Edit This Page</a>
                </div>
                <p>You can run code <em>before</em> and <em>after</em> your Slim application to manipulate the
Request and Response objects as you see fit. This is called <em>middleware</em>.
Why would you want to do this? Perhaps you want to protect your app
from cross-site request forgery. Maybe you want to authenticate requests
before your app runs. Middleware is perfect for these scenarios.</p>

<h2 id="what-is-middleware"><a class="dashAnchor" name="//apple_ref/cpp/Section/What%20is%20middleware%3F"></a>What is middleware?</h2>

<p>Technically speaking, a middleware is a <em>callable</em> that accepts three arguments:</p>

<ol>
  <li><code class="highlighter-rouge">\Psr\Http\Message\ServerRequestInterface</code> - The PSR7 request object</li>
  <li><code class="highlighter-rouge">\Psr\Http\Message\ResponseInterface</code> - The PSR7 response object</li>
  <li><code class="highlighter-rouge">callable</code> - The next middleware callable</li>
</ol>

<p>It can do whatever is appropriate with these objects. The only hard requirement
is that a middleware <strong>MUST</strong> return an instance of <code class="highlighter-rouge">\Psr\Http\Message\ResponseInterface</code>.
Each middleware <strong>SHOULD</strong> invoke the next middleware and pass it Request and
Response objects as arguments.</p>

<h2 id="how-does-middleware-work"><a class="dashAnchor" name="//apple_ref/cpp/Section/How%20does%20middleware%20work%3F"></a>How does middleware work?</h2>

<p>Different frameworks use middleware differently. Slim adds middleware as concentric
layers surrounding your core application. Each new middleware layer surrounds
any existing middleware layers. The concentric structure expands outwardly as
additional middleware layers are added. The last middleware layer added is the first to be executed.</p>

<p>When you run the Slim application, the Request and Response objects traverse the
middleware structure from the outside in. They first enter the outer-most middleware,
then the next outer-most middleware, (and so on), until they ultimately arrive
at the Slim application itself. After the Slim application dispatches the
appropriate route, the resultant Response object exits the Slim application and
traverses the middleware structure from the inside out. Ultimately, a final
Response object exits the outer-most middleware, is serialized into a raw HTTP
response, and is returned to the HTTP client. Here’s a diagram that illustrates
the middleware process flow:</p>

<div style="padding: 2em 0; text-align: center">
    <img alt="Middleware architecture" src="../images/middleware.png" style="max-width: 80%;"/>
</div>

<h2 id="how-do-i-write-middleware"><a class="dashAnchor" name="//apple_ref/cpp/Section/How%20do%20I%20write%20middleware%3F"></a>How do I write middleware?</h2>

<p>Middleware is a callable that accepts three arguments: a Request object, a Response object, and the next middleware. Each middleware <strong>MUST</strong> return an instance of <code class="highlighter-rouge">\Psr\Http\Message\ResponseInterface</code>.</p>

<h3 id="closure-middleware-example"><a class="dashAnchor" name="//apple_ref/cpp/Section/Closure%20middleware%20example."></a>Closure middleware example.</h3>

<p>This example middleware is a Closure.</p>

<figure class="highlight"><pre><code class="language-php" data-lang="php"><span class="cp">&lt;?php</span>
<span class="sd">/**
 * Example middleware closure
 *
 * @param  \Psr\Http\Message\ServerRequestInterface $request  PSR7 request
 * @param  \Psr\Http\Message\ResponseInterface      $response PSR7 response
 * @param  callable                                 $next     Next middleware
 *
 * @return \Psr\Http\Message\ResponseInterface
 */</span>
<span class="k">function</span> <span class="p">(</span><span class="nv">$request</span><span class="p">,</span> <span class="nv">$response</span><span class="p">,</span> <span class="nv">$next</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$response</span><span class="o">-&gt;</span><span class="na">getBody</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">write</span><span class="p">(</span><span class="s1">'BEFORE'</span><span class="p">);</span>
    <span class="nv">$response</span> <span class="o">=</span> <span class="nv">$next</span><span class="p">(</span><span class="nv">$request</span><span class="p">,</span> <span class="nv">$response</span><span class="p">);</span>
    <span class="nv">$response</span><span class="o">-&gt;</span><span class="na">getBody</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">write</span><span class="p">(</span><span class="s1">'AFTER'</span><span class="p">);</span>

    <span class="k">return</span> <span class="nv">$response</span><span class="p">;</span>
<span class="p">};</span></code></pre></figure>

<h3 id="invokable-class-middleware-example"><a class="dashAnchor" name="//apple_ref/cpp/Section/Invokable%20class%20middleware%20example"></a>Invokable class middleware example</h3>

<p>This example middleware is an invokable class that implements the magic <code class="highlighter-rouge">__invoke()</code> method.</p>

<figure class="highlight"><pre><code class="language-php" data-lang="php"><span class="cp">&lt;?php</span>
<span class="k">class</span> <span class="nc">ExampleMiddleware</span>
<span class="p">{</span>
    <span class="sd">/**
     * Example middleware invokable class
     *
     * @param  \Psr\Http\Message\ServerRequestInterface $request  PSR7 request
     * @param  \Psr\Http\Message\ResponseInterface      $response PSR7 response
     * @param  callable                                 $next     Next middleware
     *
     * @return \Psr\Http\Message\ResponseInterface
     */</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">__invoke</span><span class="p">(</span><span class="nv">$request</span><span class="p">,</span> <span class="nv">$response</span><span class="p">,</span> <span class="nv">$next</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="nv">$response</span><span class="o">-&gt;</span><span class="na">getBody</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">write</span><span class="p">(</span><span class="s1">'BEFORE'</span><span class="p">);</span>
        <span class="nv">$response</span> <span class="o">=</span> <span class="nv">$next</span><span class="p">(</span><span class="nv">$request</span><span class="p">,</span> <span class="nv">$response</span><span class="p">);</span>
        <span class="nv">$response</span><span class="o">-&gt;</span><span class="na">getBody</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">write</span><span class="p">(</span><span class="s1">'AFTER'</span><span class="p">);</span>

        <span class="k">return</span> <span class="nv">$response</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre></figure>

<p>To use this class as a middleware, you can use <code class="highlighter-rouge">-&gt;add( new ExampleMiddleware() );</code> function chain after the <code class="highlighter-rouge">$app</code>, <code class="highlighter-rouge">Route</code>,  or <code class="highlighter-rouge">group()</code>, which in the code below, any one of these, could represent $subject.</p>

<figure class="highlight"><pre><code class="language-php" data-lang="php">$subject-&gt;add( new ExampleMiddleware() );</code></pre></figure>

<h2 id="how-do-i-add-middleware"><a class="dashAnchor" name="//apple_ref/cpp/Section/How%20do%20I%20add%20middleware%3F"></a>How do I add middleware?</h2>

<p>You may add middleware to a Slim application, to an individual Slim application route or to a route group. All scenarios accept the same middleware and implement the same middleware interface.</p>

<h3 id="application-middleware"><a class="dashAnchor" name="//apple_ref/cpp/Section/Application%20middleware"></a>Application middleware</h3>

<p>Application middleware is invoked for every <em>incoming</em> HTTP request. Add application middleware with the Slim application instance’s <code class="highlighter-rouge">add()</code> method. This example adds the Closure middleware example above:</p>

<figure class="highlight"><pre><code class="language-php" data-lang="php"><span class="cp">&lt;?php</span>
<span class="nv">$app</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">\Slim\App</span><span class="p">();</span>

<span class="nv">$app</span><span class="o">-&gt;</span><span class="na">add</span><span class="p">(</span><span class="k">function</span> <span class="p">(</span><span class="nv">$request</span><span class="p">,</span> <span class="nv">$response</span><span class="p">,</span> <span class="nv">$next</span><span class="p">)</span> <span class="p">{</span>
	<span class="nv">$response</span><span class="o">-&gt;</span><span class="na">getBody</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">write</span><span class="p">(</span><span class="s1">'BEFORE'</span><span class="p">);</span>
	<span class="nv">$response</span> <span class="o">=</span> <span class="nv">$next</span><span class="p">(</span><span class="nv">$request</span><span class="p">,</span> <span class="nv">$response</span><span class="p">);</span>
	<span class="nv">$response</span><span class="o">-&gt;</span><span class="na">getBody</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">write</span><span class="p">(</span><span class="s1">'AFTER'</span><span class="p">);</span>

	<span class="k">return</span> <span class="nv">$response</span><span class="p">;</span>
<span class="p">});</span>

<span class="nv">$app</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">'/'</span><span class="p">,</span> <span class="k">function</span> <span class="p">(</span><span class="nv">$request</span><span class="p">,</span> <span class="nv">$response</span><span class="p">,</span> <span class="nv">$args</span><span class="p">)</span> <span class="p">{</span>
	<span class="nv">$response</span><span class="o">-&gt;</span><span class="na">getBody</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">write</span><span class="p">(</span><span class="s1">' Hello '</span><span class="p">);</span>

	<span class="k">return</span> <span class="nv">$response</span><span class="p">;</span>
<span class="p">});</span>

<span class="nv">$app</span><span class="o">-&gt;</span><span class="na">run</span><span class="p">();</span></code></pre></figure>

<p>This would output this HTTP response body:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>BEFORE Hello AFTER
</code></pre>
</div>

<h3 id="route-middleware"><a class="dashAnchor" name="//apple_ref/cpp/Section/Route%20middleware"></a>Route middleware</h3>

<p>Route middleware is invoked <em>only if</em> its route matches the current HTTP request method and URI. Route middleware is specified immediately after you invoke any of the Slim application’s routing methods (e.g., <code class="highlighter-rouge">get()</code> or <code class="highlighter-rouge">post()</code>). Each routing method returns an instance of <code class="highlighter-rouge">\Slim\Route</code>, and this class provides the same middleware interface as the Slim application instance. Add middleware to a Route with the Route instance’s <code class="highlighter-rouge">add()</code> method. This example adds the Closure middleware example above:</p>

<figure class="highlight"><pre><code class="language-php" data-lang="php"><span class="cp">&lt;?php</span>
<span class="nv">$app</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">\Slim\App</span><span class="p">();</span>

<span class="nv">$mw</span> <span class="o">=</span> <span class="k">function</span> <span class="p">(</span><span class="nv">$request</span><span class="p">,</span> <span class="nv">$response</span><span class="p">,</span> <span class="nv">$next</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$response</span><span class="o">-&gt;</span><span class="na">getBody</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">write</span><span class="p">(</span><span class="s1">'BEFORE'</span><span class="p">);</span>
    <span class="nv">$response</span> <span class="o">=</span> <span class="nv">$next</span><span class="p">(</span><span class="nv">$request</span><span class="p">,</span> <span class="nv">$response</span><span class="p">);</span>
    <span class="nv">$response</span><span class="o">-&gt;</span><span class="na">getBody</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">write</span><span class="p">(</span><span class="s1">'AFTER'</span><span class="p">);</span>

    <span class="k">return</span> <span class="nv">$response</span><span class="p">;</span>
<span class="p">};</span>

<span class="nv">$app</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">'/'</span><span class="p">,</span> <span class="k">function</span> <span class="p">(</span><span class="nv">$request</span><span class="p">,</span> <span class="nv">$response</span><span class="p">,</span> <span class="nv">$args</span><span class="p">)</span> <span class="p">{</span>
	<span class="nv">$response</span><span class="o">-&gt;</span><span class="na">getBody</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">write</span><span class="p">(</span><span class="s1">' Hello '</span><span class="p">);</span>

	<span class="k">return</span> <span class="nv">$response</span><span class="p">;</span>
<span class="p">})</span><span class="o">-&gt;</span><span class="na">add</span><span class="p">(</span><span class="nv">$mw</span><span class="p">);</span>

<span class="nv">$app</span><span class="o">-&gt;</span><span class="na">run</span><span class="p">();</span></code></pre></figure>

<p>This would output this HTTP response body:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>BEFORE Hello AFTER
</code></pre>
</div>

<h3 id="group-middleware"><a class="dashAnchor" name="//apple_ref/cpp/Section/Group%20Middleware"></a>Group Middleware</h3>

<p>In addition to the overall application, and standard routes being able to accept middleware, the <code class="highlighter-rouge">group()</code> multi-route definition functionality, also allows individual routes internally. Route group middleware is invoked <em>only if</em> its route matches one of the defined HTTP request methods and URIs from the group. To add middleware within the callback, and entire-group middleware to be set by chaining <code class="highlighter-rouge">add()</code> after the <code class="highlighter-rouge">group()</code> method.</p>

<p>Sample Application, making use of callback middleware on a group of url-handlers</p>

<figure class="highlight"><pre><code class="language-php" data-lang="php"><span class="cp">&lt;?php</span>

<span class="k">require_once</span> <span class="nx">__DIR__</span><span class="o">.</span><span class="s1">'/vendor/autoload.php'</span><span class="p">;</span>

<span class="nv">$app</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">\Slim\App</span><span class="p">();</span>

<span class="nv">$app</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">'/'</span><span class="p">,</span> <span class="k">function</span> <span class="p">(</span><span class="nv">$request</span><span class="p">,</span> <span class="nv">$response</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nv">$response</span><span class="o">-&gt;</span><span class="na">getBody</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">write</span><span class="p">(</span><span class="s1">'Hello World'</span><span class="p">);</span>
<span class="p">});</span>

<span class="nv">$app</span><span class="o">-&gt;</span><span class="na">group</span><span class="p">(</span><span class="s1">'/utils'</span><span class="p">,</span> <span class="k">function</span> <span class="p">()</span> <span class="k">use</span> <span class="p">(</span><span class="nv">$app</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$app</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">'/date'</span><span class="p">,</span> <span class="k">function</span> <span class="p">(</span><span class="nv">$request</span><span class="p">,</span> <span class="nv">$response</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nv">$response</span><span class="o">-&gt;</span><span class="na">getBody</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">write</span><span class="p">(</span><span class="nb">date</span><span class="p">(</span><span class="s1">'Y-m-d H:i:s'</span><span class="p">));</span>
    <span class="p">});</span>
    <span class="nv">$app</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">'/time'</span><span class="p">,</span> <span class="k">function</span> <span class="p">(</span><span class="nv">$request</span><span class="p">,</span> <span class="nv">$response</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nv">$response</span><span class="o">-&gt;</span><span class="na">getBody</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">write</span><span class="p">(</span><span class="nb">time</span><span class="p">());</span>
    <span class="p">});</span>
<span class="p">})</span><span class="o">-&gt;</span><span class="na">add</span><span class="p">(</span><span class="k">function</span> <span class="p">(</span><span class="nv">$request</span><span class="p">,</span> <span class="nv">$response</span><span class="p">,</span> <span class="nv">$next</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$response</span><span class="o">-&gt;</span><span class="na">getBody</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">write</span><span class="p">(</span><span class="s1">'It is now '</span><span class="p">);</span>
    <span class="nv">$response</span> <span class="o">=</span> <span class="nv">$next</span><span class="p">(</span><span class="nv">$request</span><span class="p">,</span> <span class="nv">$response</span><span class="p">);</span>
    <span class="nv">$response</span><span class="o">-&gt;</span><span class="na">getBody</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">write</span><span class="p">(</span><span class="s1">'. Enjoy!'</span><span class="p">);</span>

    <span class="k">return</span> <span class="nv">$response</span><span class="p">;</span>
<span class="p">});</span></code></pre></figure>

<p>When calling the <code class="highlighter-rouge">/utils/date</code> method, this would output a string similar to the below</p>

<div class="highlighter-rouge"><pre class="highlight"><code>It is now 2015-07-06 03:11:01. Enjoy!
</code></pre>
</div>

<p>visiting <code class="highlighter-rouge">/utils/time</code> would output a string similar to the below</p>

<div class="highlighter-rouge"><pre class="highlight"><code>It is now 1436148762. Enjoy!
</code></pre>
</div>

<p>but visiting <code class="highlighter-rouge">/</code> <em>(domain-root)</em>, would be expected to generate the following output as no middleware has been assigned</p>

<div class="highlighter-rouge"><pre class="highlight"><code>Hello World
</code></pre>
</div>


            </div>
        </div>

        <footer class="site-footer">
            <p>
                Created and maintained by <br/>
                <a href="http://joshlockhart.com/">Josh Lockhart</a>,
                <a href="http://www.silentworks.co.uk/" target="_blank">Andrew Smith</a>,
                <a href="http://akrabat.com/" target="_blank">Rob Allen</a>, and the
                <a href="https://github.com/orgs/slimphp/people" target="_blank">Slim Framework Team</a>
            </p>
            <form action="https://www.paypal.com/cgi-bin/webscr" method="post" style="margin: 0; padding-top: 20px" target="_blank">
                <input name="cmd" type="hidden" value="_s-xclick"/>
                <input name="hosted_button_id" type="hidden" value="9YRVXHRZT6H3L"/>
                <input alt="PayPal - The safer, easier way to pay online!" border="0" name="submit" src="https://www.paypalobjects.com/en_US/i/btn/btn_donateCC_LG.gif" type="image"/>
                <img alt="" border="0" height="1" src="https://www.paypalobjects.com/en_US/i/scr/pixel.gif" width="1"/>
            </form>
        </footer>
    </div>
</div>
        
        
        
        
        
        
    




</body><!-- Mirrored from www.slimframework.com/docs/concepts/middleware.html by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 22 Jun 2016 21:03:41 GMT --></html>